<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>7.3. Processing the</title><meta name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="The NISP tools"/><link rel="up" href="ch07.html" title="Chapter 7. Working with the"/><link rel="prev" href="ch07s02.html" title="7.2. Editing the"/><link rel="next" href="ch07s04.html" title="7.4. Publishing the NISP"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.3. Processing the </th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch07s02.html">Prev</a> </td><th width="60%" align="center">Chapter 7. Working with the </th><td width="20%" align="right"> <a accesskey="n" href="ch07s04.html">Next</a></td></tr></table><hr/></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ant"/>7.3. Processing the </h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d0e3368"/>7.3.1. The Build Tool Ant</h3></div></div></div><p>The Ant tool developed by the Apache group, build its
targets<sup>[<a id="d0e3373" href="#ftn.d0e3373" class="footnote">16</a>]</sup> according to an XML based configuration
file. In the tools distribution we have two Ant configuration
files. One is called <code class="filename">build.xml</code> and is used to
generate the architecture document for nations and the NATO intranet
are all these document are thefore labeled <span class="emphasis"><em>NATO/EAPC
UNCLASSIFIED</em></span>. The other file is called
<code class="filename">build-internet.xml</code> and is used to create a
version of the  with will be published on the internet and are
thefore created without any classification labels. Both files are
located in the root directory of this distribution. These build files
are more or less self-explanatory, and describes the different targets
and sub-targets, which should be executed in order to create HTML- and
PDF versions of the . If some of the XML files and XSLT
stylesheets are modified after a build, only the targets, which
depends on the modified files are build in a subsequent execution of
Ant.</p><p>This build files also takes care of the creation of new
distributions, as e.g. a new nisp tools distribution, a new
distribution of the source and also takes care of the task of creating
a web version of the technical architecture, etc.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="s2-cmd-antrun"/>7.3.2. Running Ant from a Command Shell</h3></div></div></div><p>As all Java programs in the tool distribution, the Ant
executable is embedded inside a Java jar file. In order to simplify
the execution, two script files <code class="filename">build.bat</code> and
<code class="filename">build.sh</code> are included for Windows respectively
Unix. These scripts calls the Ant program and is executed using the
syntax:</p><pre class="programlisting">
   .\build.bat [options] [target [target2] ...]]  (Win32)

   ./build.sh  [options] [target [target2] ...]]  (Unix)
 </pre><p>In order to run Ant on the provided build file, the user should
open a command shell, and then run the script files from the
directory, where the build file is located. The legal parameters for
ant and therefore the build script are the following:</p><pre class="programlisting">
 
 build [options] [target [target2 [target3] ...]]
 Options: 
   -help                  print this message
   -projecthelp           print project help information
   -version               print the version information and exit
   -diagnostics           print information that might be helpful to
			  diagnose or report problems.
   -quiet, -q             be extra quiet
   -verbose, -v           be extra verbose
   -debug                 print debugging information
   -emacs                 produce logging information without adornments
   -logfile &lt;file&gt;        use given file for log
     -l     &lt;file&gt;                ''
   -logger &lt;classname&gt;    the class which is to perform logging
   -listener &lt;classname&gt;  add an instance of class as a project listener
   -buildfile &lt;file&gt;      use given buildfile
     -file    &lt;file&gt;              ''
     -f       &lt;file&gt;              ''
   -D&lt;property&gt;=&lt;value&gt;   use value for given property
   -propertyfile &lt;name&gt;   load all properties from file with -D
			  properties taking precedence
   -inputhandler &lt;class&gt;  the class which will handle input requests
   -find &lt;file&gt;           search for buildfile towards the root of the
			  filesystem and use it
 
 </pre><p>If the name of the actual build file is not specified in the
example, the ant system will by default select the build file
<code class="filename">build.xml</code>. So in order to create a classified
version of the , In the above example, the following command
should be executed:</p><pre class="programlisting">
   .\build.bat -f build-internet.xml [options] [target [target2] ...]]  (Win32)

   ./build.sh  -f build-internet.xml [options] [target [target2] ...]]  (Unix)
 </pre></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="s2-jedit-antrun"/>7.3.3. Running Ant from jEdit</h3></div></div></div><p>When using the editor jEdit, it is now possible to edit the
documents and build all the html- and pdf versions of the  from
within jEdit. The jEdit plugin AntFarm integrates the Ant tool, and
thereby the  building process into the editor.</p><p>FIXME:</p><div class="figure"><a id="d0e3419"/><p class="title"><b>Figure 7.2. AntFarm Build</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="AntFarmBuild-1.1.jpg" align="middle" alt="AntFarm Build"/></div></div><p/></div><br class="figure-break"/></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="s2-ant-targets"/>7.3.4. General Ant Targets in build.xml</h3></div></div></div><p>The build file <code class="filename">bild.xml</code> comes with a number
of predefined target, which are goals, that must be solved. On such
goal could be to create a chunked HTML version of a volume, another
goal could be to create a PDF version of a volume.</p><p>The dependency of a number of the targets are illustrated in
<a class="xref" href="ch07s03.html#fig-targ-dep" title="Figure 7.3. Target Dependencies">Figure 7.3, “Target Dependencies”</a>. There we can see, that the default
target <span class="emphasis"><em>all</em></span> depends on the targets
<span class="emphasis"><em>html</em></span> and <span class="emphasis"><em>pdf</em></span>. The target
<span class="emphasis"><em>pdf</em></span> depends on <span class="emphasis"><em>vol1.pdf</em></span>,
<span class="emphasis"><em>vol2.pdf</em></span> etc. Note that
<span class="emphasis"><em>vol1.pdf</em></span> is a target and have nothing to do a
file with a similar name.</p><div class="figure"><a id="fig-targ-dep"/><p class="title"><b>Figure 7.3. Target Dependencies</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="tag-dep.jpg" align="middle" alt="Target Dependencies"/></div></div><p/></div><br class="figure-break"/><p>Currently the main targets are:</p><div class="informaltable"><p/><table border="1"><colgroup><col width="14*"/><col width="14*"/><col width="14*"/><col width="14*"/><col width="14*"/><col width="14*"/><col width="16*"/></colgroup><thead><tr><th>Volume 1</th><th>Volume 2</th><th>Volume 3</th><th>Volume 4</th><th>Volume 5</th><th>Rationale Document</th><th>Comment</th></tr></thead><tbody><tr><td>vol1</td><td>vol2</td><td>vol3</td><td>vol4</td><td>vol5</td><td>rationale</td><td>Create a HTML and PDF version of the document</td></tr><tr><td>vol1.html</td><td>vol2.html</td><td>vol3.html</td><td>vol4.html</td><td>vol5.html</td><td>rationale.html</td><td>Create a HTML version of the document</td></tr><tr><td>vol1.pdf</td><td>vol2.pdf</td><td>vol3.pdf</td><td>vol4.pdf</td><td>vol5.pdf</td><td>rationale.pdf</td><td>Create a PDF version of the volume</td></tr><tr><td>-</td><td>-</td><td>v3.merge<sup>[<a id="d0e3544" href="#ftn.d0e3544" class="footnote">a</a>]</sup></td><td>v4.merge</td><td>-</td><td>rd.merge</td><td>Merge the standards into the volume</td></tr><tr><td>valid1</td><td>valid2</td><td>valid3</td><td>valid4</td><td>valid5</td><td>valid-rationale</td><td>Check if the document is valid<sup>[<a id="d0e3581" href="#ftn.d0e3581" class="footnote">b</a>]</sup></td></tr></tbody><tbody class="footnotes"><tr><td colspan="7"><div class="footnote"><p><sup>[<a id="ftn.d0e3544" href="#d0e3544" class="para">a</a>] </sup>Merge the standard database with volume 3. What it
     actually does, is to merge the content of the files
     <code class="filename">vol3.xml</code>, <code class="filename">v3appendixA.xml</code>
     and <code class="filename">ta-standards.xml</code> and as a result create the file
     <code class="filename">vol3-merged.xml</code></p></div><div class="footnote"><p><sup>[<a id="ftn.d0e3581" href="#d0e3581" class="para">b</a>] </sup>Note the jEdit editor 
     automatically validates a document, if the XML plugin is 
     installed</p></div></td></tr></tbody></table><p/></div><p>There is actually an additional target for volume 3, which is
called <code class="literal">vol3-check</code>, but this target is used by one
of the targets already mentioned to decide if it is necessary at all
to rebuild a given target, depending on the date of the files
involved. This target should therefore never explicit be executed by
the user. For a list of all the targets available, the user should
under windows run the command:</p><pre class="programlisting">
    .\build.bat  -projecthelp
 </pre><p>Besides similar targets for the other volumes, and targets for
the master document and acronyms a few targets should also be
mentioned.</p><div class="informaltable"><p/><table border="0"><colgroup><col width="18*"/><col width="82*"/></colgroup><thead><tr><th><span class="bold"><strong>Target</strong></span></th><th><span class="bold"><strong>Comment</strong></span></th></tr></thead><tbody><tr><td>all</td><td>If the user do not supply a target, the default
     target <span class="emphasis"><em>all</em></span> is build. This target create a
     <code class="filename">build</code> 
     directory<sup>[<a id="d0e3617" href="#ftn.d0e3617" class="footnote">a</a>]</sup>, and 
     then build all volumes, and also 
     copy additionally files to this directory, such as e.g. the figures and
     icons used in the documents, plus additional files
     necessary.</td></tr><tr><td>html</td><td>Create HTML of all  documents, the rationale, the master and 
     the acronyms pages.</td></tr><tr><td>pdf</td><td>Create a PDF version of all the  documents, and the rationale
     document.</td></tr><tr><td>doc</td><td>Create the documentation of the  tools
     distribution. That is currently only this
     document.</td></tr></tbody><tbody class="footnotes"><tr><td colspan="2"><div class="footnote"><p><sup>[<a id="ftn.d0e3617" href="#d0e3617" class="para">a</a>] </sup>This directory is 
     located in the root of the tools distribution</p></div></td></tr></tbody></table><p/></div><p>A number of target exists specifically to clean up the
filesystem of generated. Usually these targets deletes the generated
html and pdf files.</p><div class="informaltable"><p/><table border="0"><colgroup><col width="18*"/><col width="82*"/></colgroup><thead><tr><th><span class="bold"><strong>Target</strong></span></th><th><span class="bold"><strong>Comment</strong></span></th></tr></thead><tbody><tr><td>clean-build</td><td>Delete the <code class="filename">build</code> directory.</td></tr><tr><td>clean-dist</td><td>Delete the <code class="filename">dist</code> directory</td></tr><tr><td>clean-zip</td><td>Delete the <code class="filename">zip</code> directory</td></tr><tr><td>clean</td><td>Remove all generated files, from the <code class="filename">build</code>- and <code class="filename">dist</code> - directories.</td></tr></tbody></table><p/></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e3686"/>7.3.4.1. Special distribution targets</h4></div></div></div><p>The following targets, should only be used by the editor of the
 and the maintainer of the nisp tool package. All the archives
generated by these targets are saved in the subdirectory <code class="filename">zip</code>.</p><div class="informaltable"><p/><table border="0"><colgroup><col width="18*"/><col width="82*"/></colgroup><thead><tr><th><span class="bold"><strong>Target</strong></span></th><th><span class="bold"><strong>Comment</strong></span></th></tr></thead><tbody><tr><td>source</td><td>Create a new source distribution of the . This target
     should normally only be executed by the editor of the . The
     name of the archive could e.g. be
     <code class="filename">nisp-src-3.0.zip</code> and will be
     placed in the subdirectory <code class="filename">zip</code></td></tr><tr><td>tool</td><td>Create a new tool distribution of the . This target
     should normally only be executed by the maintainer of the
     nisp-tools package.  The appropriate files from the tool
     directory are copied to the <code class="filename">dist</code> directory, and a new archive is
     created. The name of the archive could e.g. be named e.g
     <code class="filename">nisp-tool-3.1.zip</code> and will be
     placed in the subdirectory <code class="filename">zip</code>.</td></tr><tr><td>web</td><td>Create a archive of the files, necessary
     for a Web version of the . The name of the archive could e.g. be
     named  e.g <code class="filename">nisp-web-3.0.zip</code> and will be
     placed in the subdirectory <code class="filename">zip</code>.</td></tr><tr><td>pdf-only</td><td>Create an archive with PDF versions of all the  documents.  
     The name of the archive could e.g. be
     named  e.g <code class="filename">nisp-pdf-3.0.zip</code> and will be
     placed in the subdirectory <code class="filename">zip</code>.</td></tr><tr><td>xsl</td><td>Create a <span class="emphasis"><em>stylesheet only</em></span>
     distribution. Used to release stylesheet distributions in between
     normal tools releases.</td></tr><tr><td>zip</td><td>Create the source, tool, xsl, web and pdf-only archives</td></tr></tbody></table><p/></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e3766"/>7.3.4.2. Validating a document</h4></div></div></div><p>It was previous mentioned, that there are Ant targets, which are
used to validate XML document (i.e. that obey the syntax of the
DocBook DTD). This is necessary, since existing many editors currently
are not XML-aware, and it is therefore necessary for the author to
ensure, that he is writing a syntactically correct DocBook
document. Because the the DocBook syntax is very large, the user can
not manually verify the correctness of the document, but must use a
validating parser. Saxon comes with a non-validating parser, which is
why the validating parser Xerces is included in the tools distribution
and is used for this purpose.</p><p>When the user wants to validate volume 5 (under Windows), the
following command is executed </p><pre class="programlisting">
   .\build.bat valid5
 </pre><p>This result in the following output from the validation
 process:</p><pre class="programlisting">
   Buildfile: build.xml

   valid5:
   /home/js/work/noswg/xml-nisp/tools/src/volume5/vol5.xml: 3917 ms 
	   (3725 elems, 522 attrs, 10080 spaces, 133734 chars)

   BUILD SUCCESSFUL

   Total time: 6 seconds
 </pre><p>The program used to validate a XML files, is called SAXCount and
is a sample application included with the Xerces distribution. It is
actually used to count the number of elements, attributes, text
characters and ignorable white-space characters in the document. By
default, we have turned on the validation flag, and all though the
output does not say it, volume 5 is a valid document. If that was not
the case, a large number of error messages describing the syntax
errors, would be written to the standard output.</p><p>If the editor <span class="emphasis"><em>jEdit</em></span> is used, this step is
unnecessary. Whenever a document is opened, the focus shifts to a new
document or a document is saved, the current buffer is automatically
validated .</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d0e3786"/>7.3.5. Building a internet version of the documents</h3></div></div></div><p>In order to publish a version of the  for the internet</p></div><div class="footnotes"><br/><hr width="100" align="left"/><div class="footnote"><p><sup>[<a id="ftn.d0e3373" href="#d0e3373" class="para">16</a>] </sup>A target is a task, e.g. translate volume 1 to
HTML</p></div></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07s02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch07.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch07s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">7.2. Editing the  </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 7.4. Publishing the NISP</td></tr></table></div></body></html>